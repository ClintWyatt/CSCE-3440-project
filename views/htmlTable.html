<!--Each table row is defined with the <tr> tag. A table header is defined with the <th> tag.
By default, table headings are bold and centered. A table data/cell is defined with the <td> tag.-->
<!DOCTYPE html>
<html>
    <head>
      <!--<script type="module" src="../scripts/outbreak.js"></script> -->
        <style>
        #graph {
          border-collapse: collapse;
          border: 1px solid black;
        }

        .row{
            height: 5px;
        }
        .col{
            width: 5px;
            border: 1px solid black;
            
        }
        tr{
          height: 2px;
        }
        td{
          width: 2px;
            border: 1px solid black;
            
        }

        </style>
    </head>

    <body>
        
        <h2>Possible graph using a table:</h2>
       
</br>

<script src="../scripts/outbreak.js"></script><!--including the neighborhood class and state class-->


<script>
  
  /*functions for the outbreak */
  function topLeftCorner(){
    if(neighborhood[0].getStatus() === "susceptible"){//if the current neighborhood is susceptible

      if(neighborhood[1].getStatus() === "infected")//if the neighbor to the right is infected
      {
        neighborhood[0].incrementThreshold();
      }
      if(neighborhood[size].getStatus() === "infected")//if the neighbor below is infected
      {
        neighborhood[0].incrementThreshold();
      }
      if(neighborhood[size + 1].getStatus() === "infected")//if the neighbor's bottom right diagonal is infected
      {
        neighborhood[0].incrementThreshold();
      }
    }
  }
  function topRightCorner(){
    if(neighborhood[size-1].getStatus() === "susceptible"){//if the current neighborhood is susceptible

      if(neighborhood[size -2].getStatus() === "infected")//if the neighbor to the left is infected
      {
        neighborhood[size -1].incrementThreshold();
      }
      if(neighborhood[(2 * size) -1].getStatus() === "infected")//if the neighbor below is infected
      {
        neighborhood[size -1].incrementThreshold();
      }
      if(neighborhood[(2 * size) -2].getStatus() === "infected")//if the neighbor bottom left diagonal is infected
      {
        neighborhood[size -1].incrementThreshold();
      }
    }
  }
  function bottomLeftCorner(){
    if(neighborhood[size *(size -1)].getStatus() === "susceptible"){//if the current neighborhood is susceptible

      if(neighborhood[size *(size -2)].getStatus() === "infected")//if the neighbor above is infected
      {
        neighborhood[size *(size -1)].incrementThreshold();
      }
      if(neighborhood[size *(size -2) +1].getStatus() === "infected")//if the upper right neighbor is infected
      {
        neighborhood[size *(size -1)].incrementThreshold();
      }
      if(neighborhood[size *(size -1)+1].getStatus() === "infected")//if the neighbor to the right is infected
      {
        neighborhood[size *(size -1)].incrementThreshold();
      }
    }
  } 
  function bottomRightCorner(){
    if(neighborhood[(size * size) -1].getStatus() === "susceptible"){//if the current neighborhood is susceptible

      if(neighborhood[size * (size -1)].getStatus() === "infected")//if the neighbor above is infected
      {
        neighborhood[(size * size) -1].incrementThreshold();
      }
      if(neighborhood[size *(size -1) -1].getStatus() === "infected")//if the upper left neighbor is infected
      {
        neighborhood[(size * size) -1].incrementThreshold();
      }
      if(neighborhood[(size * size) -2].getStatus() === "infected")//if the neighbor to the left is infected
      {
        neighborhood[(size * size) -1].incrementThreshold();
      }
    }
  }
  function leftSide(x){
    if(neighborhood[x].getStatus() === "susceptible"){

      if(neighborhood[x - size].getStatus()  === "infected"){//if the neighbor above is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - size +1].getStatus() === "infected"){//if the neighbor to the top right is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x+1].getStatus() === "infected"){//if the neighbor to the right is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + size +1].getStatus() === "infected"){//if the neighbor to the bottom right is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + size].getStatus() === "infected"){//if the neighbor to the bottom is infected
        neighborhood[x].incrementThreshold();
      }
    }
  }
  function rightSide(x){
    if(neighborhood[x].getStatus() === "susceptible"){//if the neighbor has not been infected yet and is not vacinated

      if(neighborhood[x - size].getStatus()  === "infected"){//if the neighbor above is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x -(size - 1)].getStatus() === "infected"){//if the neighbor to the top left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x-1].getStatus() === "infected"){//if the neighbor to the left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + (size - 1)].getStatus() === "infected"){//if the neighbor to the bottom left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + size].getStatus() === "infected"){//if the neighbor to the bottom is infected
        neighborhood[x].incrementThreshold();
      }
    }
  }
  function topRow(x){
    if(neighborhood[x].getStatus() === "susceptible"){//if the neighbor has not been infected yet and is not vacinated

      if(neighborhood[x - 1].getStatus() === "infected"){//if the neighbor to the left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + (size -1)].getStatus() === "infected"){//if the neighbor to the bottom left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + size].getStatus() === "infected"){//if the neighbor below is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + (size + 1)].getStatus() === "infected"){//if the bottom right neighbor is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + 1].getStatus() === "infected"){//if the neighbor right is infected
        neighborhood[x].incrementThreshold();
      }
    }
  }
  function bottomRow(x){
    if(neighborhood[x].getStatus() === "susceptible"){//if the neighbor has not been infected yet and is not vacinated

      if(neighborhood[x - 1].getStatus() === "infected"){//if the neighbor to the left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - (size -1)].getStatus() === "infected"){//if the neighbor to the top left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - size].getStatus() === "infected"){//if the neighbor above is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - (size + 1)].getStatus() === "infected"){//if the top right neighbor is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + 1].getStatus() === "infected"){//if the neighbor right is infected
        neighborhood[x].incrementThreshold();
      }
    }
  }
  function innerGraph(x){
    
    if(neighborhood[x].getStatus() === "susceptible"){//if the neighbor has not been infected yet and is not vacinated
      
      if(neighborhood[x - 1].getStatus() === "infected"){//if the neighbor to the left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - (size -1)].getStatus() === "infected"){//if the neighbor to the top left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - size].getStatus() === "infected"){//if the neighbor above is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x - (size + 1)].getStatus() === "infected"){//if the top right neighbor is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + 1].getStatus() === "infected"){//if the neighbor right is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + (size -1)].getStatus() === "infected"){//if the neighbor to the bottom left is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + size].getStatus() === "infected"){//if the neighbor below is infected
        neighborhood[x].incrementThreshold();
      }
      if(neighborhood[x + (size + 1)].getStatus() === "infected"){//if the bottom right neighbor is infected
        neighborhood[x].incrementThreshold();
      }
    }
  }
  /*end of simulation functions */
  var table = "<table Id = graph>";//represents a html table
  const size = 200;
  let neighborhood = [];
  var n = new Neighborhood();
  for(i =0; i < size*size; i++)
  {
    neighborhood.push(n);
    n = new Neighborhood();//must do this to prevent all objects refering to 1 object
  }
  //const neighborhood = new Neighborhood()[67,600];//creating a 2d array of neighborhoods
  
  //generating tha table graph  
  for(i = 0; i < size; i++)
  {
      table += "<tr>"
      for(j = 0; j < size; j++)
      {
         table +="<td></td>";
      }
    table += "</tr>"
  }
  table += "</table>";
  
  document.write(table); //writting the table to the document
  var x = document.getElementsByTagName("td");//getting all the columns in the table
  var infection = Math.floor(Math.random()*size); 

  /*variables for the count of different states neighborhoods could be in */
  let numInfected =0;
  let numVacinated =0;
  let numRecovered =0;
  let numsusceptible =0;
  var noInfected = false;

  //randomly set states to the graph
  for(i=0; i < x.length; i++)//number of columns in the graph
  {
    if(infection < size * .01)
    {
      x[i].style.backgroundColor = "red";//infected
      neighborhood[i].setStatus("red");
      //console.log(neighborhood[i].getStatus());
    }
    else if(infection > (size * .02) && infection <= (size * .03))
    {
      //console.log("vacinated at " +i);
      x[i].style.backgroundColor = "blue";//vacinated
      neighborhood[i].setStatus("blue");
      //console.log(neighborhood[i].getStatus());
    }
    else if(infection > (size *.03) && infection <= (size *.04))
    {
      x[i].style.backgroundColor = "green";//recovered
      neighborhood[i].setStatus("green");
      //console.log(neighborhood[i].getStatus());
    }
    else
    {
      x[i].style.backgroundColor = "yellow";//susceptible
      neighborhood[i].setStatus("yellow");
    }
    infection = Math.floor(Math.random()*size);
  }
  //console.log(neighborhood[50].getStatus());
  
 
  //start outbreak
  while(noInfected===false)
  {
    for(i=0; i < neighborhood.length; i++)//number of columns in the graph
    {
      if(i === 0)
      {
        topLeftCorner();
      }
      else if(i === size*(size -1))
      {
        bottomLeftCorner();
      }
      else if(i === size - 1)
      {
        topRightCorner();
      }
      else if(i === (size * size) -1)
      {
        bottomRightCorner();
      }
      else if(i % size ===0)
      {
        leftSide(i);
      }
      else if(i % size === size-1)
      {
        rightSide(i);
      }
      else if(i > (size * size) - size)
      {
        bottomRow(i);
      }
      else if(i < size)
      {
        topRow(i);
      }
      else
      {
        innerGraph(i);
      }
    }
    noInfected = true;//for debugging purposes
    //get information about infected neighborhoods from the graph
    /*for(j =0; j < neighborhood.length; j++)
    {
      if(neighborhood[j].getThreshold() > 1){ console.log(neighborhood[j].getThreshold() + " at " +j);}
    }
  */
  }

  //another loop needed to chenge states (infected to recovered or susceptible to infected)
</script>

<script>
  var table = document.getElementById("graph");
  var row = table.insertRow(0);
  row.height="5px";

</script>

    </body>
</html>